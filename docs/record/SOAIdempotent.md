## 背景
一般在微服务开发中会涉及到重试机制，例如一个订单支付的接口，如果接口不是幂等的，那么会产生如下问题

1. 客户端调用支付接口，传递相关支付信息
2. 服务端此时收到了请求A，正在处理请求A，由于网络原因客户端与服务端之间本次请求超时了
3. 客户端收到超时反馈，执行超时的补偿机制，举个例子，客户端重试此请求,发起请求B
4. 服务端继续执行请求A，完成了支付
5. 服务端收到请求B，执行请求B，完成了支付

如此就产生了由于接口幂等性问题出现的重复扣款
## 解决方案
1. 请求携带流水号，如UUID(可以写一个统一的地方，把请求体注入UUID， 比如切面)
2. 客户端发起请求，请求体携带UUID，服务端收到请求后把UUID先落地到比如redis，或者mysql等数据库
3. 客户端收到超时后，再次查询，服务端发现UUID存在于redis后，直接返回结果处理中
## 其他
幂等性实际还是要结合具体业务， 比如可以创建唯一索引， 可以根据具体业务中的唯一key来实现幂等